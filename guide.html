<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MapFlow Pro - Complete Setup Guide</title>
    <meta name="description" content="Complete step-by-step guide for MapFlow Pro installation, configuration, and troubleshooting">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #030E4F 0%, #1a237e 100%);
            min-height: 100vh;
        }

        /* Navigation Styles */
        .navigation {
            background: rgba(255, 255, 255, 0.95);
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            padding: 12px 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .nav-links {
            display: flex;
            align-items: center;
            justify-content: flex-start;
            gap: 0;
        }

        .nav-link {
            color: #666;
            text-decoration: none;
            padding: 8px 16px;
            font-weight: 500;
            transition: all 0.3s ease;
            font-size: 0.95rem;
        }

        .nav-link:hover {
            color: #F49F1C;
            text-decoration: none;
        }

        .nav-link.active {
            color: #F49F1C;
            font-weight: 600;
        }

        .nav-separator {
            color: #999;
            font-size: 0.9rem;
            margin: 0 8px;
            font-weight: 400;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
            padding: 40px 0;
        }

        .header h1 {
            font-size: 3.5rem;
            font-weight: 800;
            margin-bottom: 20px;
            background: linear-gradient(45deg, #F49F1C, #ffd54f);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header .subtitle {
            font-size: 1.4rem;
            color: #E8F4FD;
            margin-bottom: 30px;
        }

        .content {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .guide-section {
            padding: 40px;
            border-bottom: 1px solid #eee;
        }

        .guide-section:last-child {
            border-bottom: none;
        }

        .section-header {
            display: flex;
            align-items: center;
            margin-bottom: 30px;
        }

        .section-emoji {
            font-size: 2.5rem;
            margin-right: 15px;
        }

        .section-title {
            font-size: 2rem;
            font-weight: 700;
            color: #030E4F;
        }

        .section-content h3 {
            color: #030E4F;
            font-size: 1.4rem;
            font-weight: 600;
            margin: 25px 0 15px 0;
            display: flex;
            align-items: center;
        }

        .section-content h3::before {
            content: "▶";
            color: #F49F1C;
            margin-right: 10px;
            font-size: 0.8em;
        }

        .section-content p {
            margin-bottom: 15px;
            color: #555;
            font-size: 1.1rem;
        }

        .section-content ul {
            margin: 15px 0 15px 25px;
        }

        .section-content li {
            margin-bottom: 8px;
            color: #555;
            font-size: 1.05rem;
        }

        .steps-list {
            counter-reset: step-counter;
            list-style: none;
            margin: 25px 0;
        }

        .steps-list li {
            counter-increment: step-counter;
            margin-bottom: 20px;
            padding: 20px;
            background: #f8f9ff;
            border-radius: 12px;
            border-left: 4px solid #F49F1C;
            position: relative;
        }

        .steps-list li::before {
            content: counter(step-counter);
            position: absolute;
            left: -15px;
            top: 15px;
            background: #F49F1C;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .code-block {
            background: #1e293b;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 12px;
            font-family: 'JetBrains Mono', 'Fira Code', monospace;
            font-size: 0.95rem;
            overflow-x: auto;
            margin: 20px 0;
            border: 1px solid #334155;
        }

        .code-block .comment {
            color: #64748b;
        }

        .code-block .property {
            color: #f59e0b;
        }

        .code-block .value {
            color: #10b981;
        }

        .alert {
            background: linear-gradient(135deg, #fef3c7 0%, #fcd34d 20%);
            border: 1px solid #f59e0b;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid #f59e0b;
        }

        .alert-title {
            font-weight: 700;
            color: #92400e;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .warning {
            background: linear-gradient(135deg, #fef2f2 0%, #fecaca 20%);
            border: 1px solid #ef4444;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid #ef4444;
        }

        .warning-title {
            font-weight: 700;
            color: #dc2626;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .success {
            background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
            border: 1px solid #10b981;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid #10b981;
        }

        .success-title {
            font-weight: 700;
            color: #059669;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .screenshot-link {
            background: linear-gradient(135deg, #F49F1C 0%, #ffa726 100%);
            color: white;
            padding: 15px 20px;
            border-radius: 12px;
            margin: 15px 0;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-block;
            text-decoration: none;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(244, 159, 28, 0.3);
        }

        .screenshot-link:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(244, 159, 28, 0.4);
            text-decoration: none;
            color: white;
        }

        .click-hint {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-left: 10px;
        }

        .config-table {
            width: 100%;
            border-collapse: collapse;
            margin: 25px 0;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .config-table th {
            background: linear-gradient(135deg, #030E4F 0%, #1a237e 100%);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .config-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
        }

        .config-table tr:hover {
            background: #f8f9ff;
        }

        .back-to-home {
            text-align: center;
            margin: 40px 0;
        }

        .back-to-home a {
            background: linear-gradient(135deg, #030E4F 0%, #1a237e 100%);
            color: white;
            padding: 15px 30px;
            border-radius: 12px;
            text-decoration: none;
            font-weight: 600;
            display: inline-block;
            transition: all 0.3s ease;
        }

        .back-to-home a:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(3, 14, 79, 0.3);
        }

        .troubleshooting-item {
            background: #f8f9ff;
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid #ef4444;
            margin: 15px 0;
        }

        .troubleshooting-item h4 {
            color: #ef4444;
            font-weight: 600;
            margin-bottom: 10px;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2.5rem;
            }
            
            .guide-section {
                padding: 25px;
            }

            .nav-links {
                flex-wrap: wrap;
                justify-content: center;
                gap: 5px;
            }

            .nav-link {
                font-size: 0.85rem;
                padding: 6px 12px;
            }

            .nav-separator {
                margin: 0 4px;
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navigation">
        <div class="nav-container">
            <div class="nav-links">
                <a href="index.html" class="nav-link">Home</a>
                <span class="nav-separator">→</span>
                <a href="ia-recommended.html" class="nav-link">AI Friendly</a>
                <span class="nav-separator">→</span>
                <a href="documentation.html" class="nav-link">Technical Documentation</a>
                <span class="nav-separator">→</span>
                <a href="guide.html" class="nav-link active">Guide</a>
                <span class="nav-separator">→</span>
                <a href="Gallery.html" class="nav-link">Gallery</a>
            </div>
        </div>
    </nav>

    <div class="container">
        <div class="header">
            <h1>🛠️ Setup Guide</h1>
            <div class="subtitle">Complete installation, configuration and troubleshooting guide</div>
        </div>

        <div class="content">
            <!-- Installation Section -->
            <div class="guide-section">
                <div class="section-header">
                    <div class="section-emoji">📦</div>
                    <div class="section-title">Installation & Initial Setup</div>
                </div>
                <div class="section-content">
                    <h3>Step 1: Install MapFlow Pro Plugin</h3>
                    
                    <div class="screenshot-link" onclick="openScreenshot('bubble-marketplace-installation-pending')">
                        📸 Screenshot: MapFlow Pro installation from Bubble marketplace
                        <span class="click-hint">👆 Click to view</span>
                    </div>

                    <ol class="steps-list">
                        <li>Go to your Bubble app editor</li>
                        <li>Navigate to Plugins tab</li>
                        <li>Click "Add plugins"</li>
                        <li>Search for "MapFlow Pro"</li>
                        <li>Click "Install" and accept the plugin</li>
                    </ol>

                    <h3>Step 2: Get HERE Maps API Key</h3>
                    
                    <div class="screenshot-link" onclick="openScreenshot('here-api-key-generation')">
                        📸 Screenshot: HERE API key generation process
                        <span class="click-hint">👆 Click to view</span>
                    </div>

                    <ol class="steps-list">
                        <li>Visit <a href="https://developer.here.com" target="_blank" style="color: #F49F1C;">developer.here.com</a></li>
                        <li>Create a FREE HERE developer account</li>
                        <li>Create a new project</li>
                        <li>Generate an API key</li>
                        <li>Copy the API key for Bubble configuration</li>
                    </ol>

                    <div class="alert">
                        <div class="alert-title">💡 HERE Free Tier</div>
                        <p>HERE provides 250,000 free requests per month, which covers most applications. No credit card required for the free tier.</p>
                    </div>

                    <h3>Step 3: Configure Privacy Rules</h3>
                    
                    <div class="screenshot-link" onclick="openScreenshot('bubble-privacy-rules-user-geolocation')">
                        📸 Screenshot: Privacy rules configuration for user geolocation
                        <span class="click-hint">👆 Click to view</span>
                    </div>

                    <div class="warning">
                        <div class="warning-title">⚠️ Critical: Privacy Rules Setup</div>
                        <p>If your map doesn't load or shows no data, privacy rules are often the cause. Ensure your data types have proper privacy rules configured:</p>
                        <ul>
                            <li>Allow "Everyone" to view location fields (lat, lng) if using public data</li>
                            <li>Or configure specific privacy rules for your user type</li>
                            <li>Check that geographic address fields are accessible</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Layout Configuration -->
            <div class="guide-section">
                <div class="section-header">
                    <div class="section-emoji">🏗️</div>
                    <div class="section-title">Critical Layout Configuration</div>
                </div>
                <div class="section-content">
                    <h3>Essential Layout Requirements</h3>
                    
                    <div class="screenshot-link" onclick="openScreenshot('bubble-layout-column-fixed-height')">
                        📸 Screenshot: Correct layout configuration - Column group with fixed height
                        <span class="click-hint">👆 Click to view</span>
                    </div>

                    <div class="warning">
                        <div class="warning-title">🚨 Layout Critical Issue</div>
                        <p><strong>The map will NOT load properly if not placed in a Column group with fixed height.</strong> This is the most common configuration error.</p>
                    </div>

                    <h3>Correct Layout Structure</h3>
                    
                    <div class="code-block">
Page Layout
└── Column Group (container for map)
    ├── Make this element fixed-height: <span class="value">ON</span>
    ├── Min height: <span class="value">600-800px</span>
    ├── Fit height to content: <span class="value">OFF</span>
    ├── Make this element fixed-width: <span class="value">OFF</span>
    └── MapFlow Element (inside this column)
                    </div>

                    <h3>Layout Settings Checklist</h3>
                    
                    <ol class="steps-list">
                        <li><strong>Container Group:</strong> Use Column (not Row) for the map container</li>
                        <li><strong>Fixed Height:</strong> Enable "Make this element fixed-height"</li>
                        <li><strong>Minimum Height:</strong> Set to at least 600px (800px recommended)</li>
                        <li><strong>Fit Height to Content:</strong> Must be OFF</li>
                        <li><strong>Width:</strong> Keep "Make this element fixed-width" OFF for responsive design</li>
                    </ol>

                    <div class="alert">
                        <div class="alert-title">💡 Layout Best Practice</div>
                        <p>Other page sections (headers, navigation, footers) can use Row layout, but the map container must always be a Column with fixed height.</p>
                    </div>
                </div>
            </div>

            <!-- Workflow Critical Section -->
            <div class="guide-section">
                <div class="section-header">
                    <div class="section-emoji">⏱️</div>
                    <div class="section-title">Critical Workflow Timing</div>
                </div>
                <div class="section-content">
                    <div class="warning">
                        <div class="warning-title">🚨 Mandatory 1000ms Pause</div>
                        <p><strong>ALWAYS add a 1000ms pause between draw_route and compute_fare actions.</strong> This ensures the route calculation completes before fare calculation begins. Without this pause, fare calculation will fail or return incorrect values.</p>
                    </div>

                    <h3>Correct Workflow Sequence</h3>
                    
                    <div class="code-block">
<span class="comment">// Workflow: Calculate Route and Fare</span>
1. Action: <span class="value">draw_route</span>
   - origin_lat: Input From's latitude
   - dest_lat: Input To's latitude
   - mode: "car"

2. Action: <span class="value">Pause</span>
   - Duration: <span class="value">1000ms</span>

3. Action: <span class="value">compute_fare</span>
   - base_fee: 3.50
   - per_km: 1.45
   - surge_multiplier: 1.0
                    </div>

                    <div class="screenshot-link" onclick="openScreenshot('mapflow-workflow-draw-route')">
                        📸 Screenshot: Draw route workflow configuration
                        <span class="click-hint">👆 Click to view</span>
                    </div>

                    <div class="alert">
                        <div class="alert-title">💡 Alternative: Use Events</div>
                        <p>Instead of a fixed pause, you can use the <strong>route_ready</strong> event to trigger the compute_fare action. This ensures perfect timing regardless of network conditions.</p>
                    </div>
                </div>
            </div>

            <!-- Element Configuration -->
            <div class="guide-section">
                <div class="section-header">
                    <div class="section-emoji">⚙️</div>
                    <div class="section-title">MapFlow Element Configuration</div>
                </div>
                <div class="section-content">
                    <h3>Basic Configuration</h3>
                    
                    <div class="screenshot-link" onclick="openScreenshot('mapflow-element-configuration')">
                        📸 Screenshot: MapFlow element configuration panel
                        <span class="click-hint">👆 Click to view</span>
                    </div>

                    <h3>Required Fields</h3>
                    
                    <table class="config-table">
                        <thead>
                            <tr>
                                <th>Field</th>
                                <th>Type</th>
                                <th>Required</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>marker_data_source</td>
                                <td>Dynamic Value</td>
                                <td>Yes</td>
                                <td>Your data source (list of things)</td>
                            </tr>
                            <tr>
                                <td>lat_key</td>
                                <td>Static text</td>
                                <td>Yes</td>
                                <td>Field name for latitude (e.g., "lat", "latitude")</td>
                            </tr>
                            <tr>
                                <td>lng_key</td>
                                <td>Static text</td>
                                <td>Yes</td>
                                <td>Field name for longitude (e.g., "lng", "longitude")</td>
                            </tr>
                            <tr>
                                <td>name_key</td>
                                <td>Static text</td>
                                <td>Optional</td>
                                <td>Field name for marker title</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Troubleshooting Section -->
            <div class="guide-section">
                <div class="section-header">
                    <div class="section-emoji">🔧</div>
                    <div class="section-title">Troubleshooting Common Issues</div>
                </div>
                <div class="section-content">
                    <h3>Map Not Loading</h3>
                    
                    <div class="troubleshooting-item">
                        <h4>❌ Issue: Map appears blank or doesn't load</h4>
                        <p><strong>Most Common Causes:</strong></p>
                        <ul>
                            <li><strong>Layout Issue:</strong> Map not in a Column group with fixed height</li>
                            <li><strong>Privacy Rules:</strong> Data fields not accessible due to privacy settings</li>
                            <li><strong>Invalid API Key:</strong> HERE API key missing or incorrect</li>
                            <li><strong>Data Source:</strong> Empty or malformed data source</li>
                        </ul>
                        <p><strong>Solutions:</strong></p>
                        <ol>
                            <li>Check layout configuration (Column + fixed height)</li>
                            <li>Verify privacy rules allow access to lat/lng fields</li>
                            <li>Test HERE API key in HERE developer console</li>
                            <li>Ensure data source contains valid latitude/longitude values</li>
                        </ol>
                    </div>

                    <div class="troubleshooting-item">
                        <h4>❌ Issue: Workflow timing problems</h4>
                        <p><strong>Common Causes:</strong></p>
                        <ul>
                            <li>compute_fare called before route completion</li>
                            <li>Missing 1000ms pause between actions</li>
                            <li>Network latency causing timing issues</li>
                        </ul>
                        <p><strong>Solutions:</strong></p>
                        <ol>
                            <li>Always add 1000ms pause after draw_route</li>
                            <li>Use route_ready event to trigger fare calculation</li>
                            <li>Check exposed states are properly referenced</li>
                        </ol>
                    </div>

                    <h3>Debug Checklist</h3>
                    <ol class="steps-list">
                        <li><strong>Layout:</strong> Verify Column group with fixed height</li>
                        <li><strong>Privacy:</strong> Check data accessibility in privacy rules</li>
                        <li><strong>API Key:</strong> Test HERE API key validity</li>
                        <li><strong>Timing:</strong> Add 1000ms pause between workflow actions</li>
                        <li><strong>Data:</strong> Inspect data source content and format</li>
                        <li><strong>Console:</strong> Check browser console for error messages</li>
                    </ol>
                </div>
            </div>
        </div>

        <div class="back-to-home">
            <a href="index.html">← Back to MapFlow Home</a>
        </div>

        <!-- Technical Documentation Request -->
        <div class="content" style="margin-top: 20px;">
            <div class="guide-section">
                <div class="alert">
                    <div class="alert-title">📄 Need Technical Documentation in PDF Format?</div>
                    <p>If you need technical documentation in PDF format for your team or organization, please send us an email at: <strong><a href="mailto:adminia@meetempo.com" style="color: #F49F1C;">adminia@meetempo.com</a></strong></p>
                    <p>We'll be happy to provide comprehensive PDF documentation tailored to your specific needs.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        function openScreenshot(screenshotId) {
            const screenshots = {
                'bubble-marketplace-installation-pending': 'https://github.com/user-attachments/assets/19c370f2-8e21-4f07-b13f-cf21a69635fd',
                'here-api-key-generation': 'https://github.com/user-attachments/assets/15dc4ce6-fd04-4029-bcb8-ffae32a50e5e',
                'bubble-privacy-rules-user-geolocation': 'https://github.com/user-attachments/assets/c5ea9a67-e10c-42a0-adf5-ec23d54df63f',
                'bubble-layout-column-fixed-height': 'https://github.com/user-attachments/assets/2e26c82c-e475-4f27-b3c7-5c293b3669c4',
                'mapflow-element-configuration': 'https://github.com/user-attachments/assets/580ca5b0-0b28-4324-9c17-5a9d3bb06989',
                'mapflow-workflow-draw-route': 'https://github.com/user-attachments/assets/94428ffc-8d6d-4ae5-8737-b1e4283ca42d'
            };
            
            if (screenshots[screenshotId]) {
                window.open(screenshots[screenshotId], '_blank');
            }
        }
    </script>
</body>
</html>
